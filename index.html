<!DOCTYPE html>
<html lang=zxx>
<title>Bezier - LeastSquares</title>

<canvas id=Canvas width=500 height=500 style="border: 1px solid black"></canvas>
<br>
<button id=Clear>CLEAR</button>

<script type=module>

const
C2D = Canvas.getContext( '2d' )

import BezierCPs from './BezierCPs.js'

const
$ = []

const
Draw = () => {
	C2D.clearRect( 0, 0, Canvas.width, Canvas.height )
	C2D.fillStyle = 'red'
	if ( $.length > 3 ) {
		C2D.beginPath()
		C2D.moveTo( ...$[ 0 ] )
		const xPQ = BezierCPs( $.map( _ => _[ 0 ] ) )
		const yPQ = BezierCPs( $.map( _ => _[ 1 ] ) )
		C2D.bezierCurveTo( xPQ[ 0 ], yPQ[ 0 ], xPQ[ 1 ], yPQ[ 1 ], ...$[ $.length - 1 ] )
		C2D.strokeStyle = 'red'
		C2D.stroke()
		C2D.fillRect( xPQ[ 0 ] - 2, yPQ[ 0 ] - 2, 4, 4 )
		C2D.fillRect( xPQ[ 1 ] - 2, yPQ[ 1 ] - 2, 4, 4 )
	}
	C2D.fillStyle = 'black'
	$.forEach( _ => C2D.fillRect( _[ 0 ] - 2, _[ 1 ] - 2, 4, 4 ) )
}

Clear.onclick = () => ( $.length = 0, Draw() )

Canvas.onclick = ev => ( $.push( [ ev.offsetX, ev.offsetY ] ), Draw() )





/*
const
fitted = fitCurve( 
	traced
,	50
)[ 0 ]
console.log( fitted )

C2D.beginPath()
C2D.moveTo( ...fitted[ 0 ] )
C2D.bezierCurveTo( ...fitted[ 1 ], ...fitted[ 2 ], ...fitted[ 3 ] )
C2D.strokeStyle = 'blue'
C2D.stroke()
*/

</script>

